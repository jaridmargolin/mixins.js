!function(a,b){"function"==typeof define&&define.amd?define(["underscore"],function(c){return a.returnExportsGlobal=b(c)}):"object"==typeof exports?module.exports=b(require("underscore")):a.mixins=b(a.underscore)}(this,function(a){var b,c,d,e;return b=function(a){return function(b,c){for(var d=b.length,e=c;d-- >0;)e=a.wrap(e,b[d]);return e}}(a),c=function(c){var d=a,e=b,f=function(a,b){this.Obj=a,this.obj=this.Obj.prototype||this.Obj,this.mixins=b||[],this.collisions={},d.each(this.mixins,this.mixin,this),d.each(this.collisions,this.createComposite,this)};return f.prototype.mixin=function(a){d.each(a,this.merge,this)},f.prototype.merge=function(a,b){b in this.obj&&!a.__mixin||(b in this.obj&&"clobber"!==a.__mixin?d.isFunction(a)?this.mergeFunction(a,b):d.isArray(a)?this.mergeArray(a,b):d.isObject(a)&&this.mergeObject(a,b):this.obj[b]=a)},f.prototype.mergeFunction=function(a,b){var c=this.obj[b]===a,e=d.contains(this.collisions[b],a),f=this.collisions.hasOwnProperty(b);c||e||(this.collisions[b]=f?this.collisions[b]:[this.obj[b]],this.collisions[b].push(a))},f.prototype.mergeArray=function(a,b){"append"===a.__mixin?this.obj[b]=this.obj[b].concat(a):"prepend"===a.__mixin?this.obj[b]=a.concat(this.obj[b]):"union"===a.__mixin&&(this.obj[b]=d.union(this.obj[b],a))},f.prototype.mergeObject=function(a,b){"extend"===a.__mixin?this.obj[b]=d.extend(this.obj[b],a):"defaults"===a.__mixin&&(this.obj[b]=d.defaults(this.obj[b],a))},f.prototype.createComposite=function(a,b){var c=this.obj[b];if("constructor"===b){var e=this.Obj;this.Obj=this.composeFn(a,c),this.Obj.prototype=this.obj,this.Obj.prototype.constructor=this.Obj,d.extend(this.Obj,e)}else this.obj[b]=this.composeFn(a,c)},f.prototype.composeFn=function(a,b){return function(){var c=d.bind(function(a,b){return d.reduce(a,function(a,c){var d=c.apply(this,b);return"undefined"==typeof d?a:d},void 0,this)},this),f=d.where(a,{__mixin:"decorate"});return e(f,function(){var e=arguments,f=d.where(a,{__mixin:"before"}),g=c(f.reverse(),e),h=b.apply(this,e),i=d.where(a,{__mixin:"after"}),j=c(i,e);return d.isUndefined(j)?d.isUndefined(h)?d.isUndefined(g)?void 0:g:h:j}).apply(this,arguments)}},f}({}),e=function(a){var b=function(a,b){return Object.defineProperty(b,"__mixin",{enumerable:!1,writable:!0}),b.__mixin=a,b};return b}({}),d=function(b){var d=a,f=c,g=e;return{Mixer:f,mixin:g,mix:function(a,b){var c=d.chain(arguments).toArray().rest().flatten().value(),e=new this.Mixer(a,c);return e.Obj}}}({})});